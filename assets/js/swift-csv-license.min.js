function initLicense(){const o=document.getElementById("swift_csv_pro_license_key_input"),i=document.getElementById("swift_csv_pro_license_toggle_visibility");o&&i&&i.addEventListener("click",()=>{const t=o.type==="password";o.type=t?"text":"password",i.textContent=t?swiftCSV.messages.hide:swiftCSV.messages.show}),document.body.addEventListener("click",async t=>{const e=t.target.closest(".swift-csv-license-button");if(!e)return;const c=e.dataset.action;if(!c)return;const l=document.getElementById("swift_csv_pro_license_key_input"),a=l?l.value:"",n=e.closest("div")?e.closest("div").querySelector(".spinner"):null;if(!a&&c==="activate"){alert(SwiftCSVCore.__("Please enter a license key.","swift-csv-pro"));return}e.disabled=!0,n&&(n.style.display="inline-block");try{const s=await(await SwiftCSVCore.wpPost("swift_csv_pro_manage_license",{nonce:swiftCSV.nonce,license_key:a,license_action:c})).json();if(console.log("License response:",s),console.log("Response success:",s.success),console.log("Response data:",s.data),!s.success)throw new Error(s.data?.message||s.message||SwiftCSVCore.__("License operation failed.","swift-csv-pro"));location.reload()}catch(r){console.error("License error:",r),alert(r.message||SwiftCSVCore.__("An error occurred while processing your request. Please try again.","swift-csv-pro"))}finally{e.disabled=!1,n&&(n.style.display="none")}})}window.SwiftCSVLicense={initLicense};
