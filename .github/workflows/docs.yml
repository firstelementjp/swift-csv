name: Generate Documentation

on:
    push:
        branches: [main, develop]
    release:
        types: [published]

permissions:
    contents: read
    pages: write
    id-token: write

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout code
              uses: actions/checkout@v3

            - name: Setup Pages
              uses: actions/configure-pages@v4

            - name: Create Docsify documentation
              run: |
                mkdir -p docs
                cat > docs/index.html << 'HTML'
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Swift CSV Documentation</title>
                    <meta charset="utf-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css">
                    <style>
                        :root {
                            --theme-color: #0073aa;
                        }
                        .sidebar {
                            background: linear-gradient(135deg, #0073aa 0%, #005a87 100%);
                            color: white;
                        }
                        .sidebar h1 {
                            color: white;
                        }
                        .sidebar p {
                            color: rgba(255, 255, 255, 0.8);
                        }
                        .badge {
                            background: #0073aa;
                            color: white;
                            padding: 4px 8px;
                            border-radius: 3px;
                            font-size: 12px;
                            margin-left: 10px;
                        }
                        .download-btn {
                            display: inline-block;
                            background: #0073aa;
                            color: white;
                            padding: 12px 24px;
                            text-decoration: none;
                            border-radius: 6px;
                            margin: 15px 0;
                            font-weight: bold;
                        }
                        .download-btn:hover {
                            background: #005a87;
                        }
                    </style>
                </head>
                <body>
                    <div id="app"></div>
                    <script>
                        window.$docsify = {
                            name: 'ğŸ“Š Swift CSV',
                            repo: 'https://github.com/firstelementjp/swift-csv',
                            loadSidebar: false,
                            loadNavbar: false,
                            maxLevel: 4,
                            subMaxLevel: 2,
                            search: 'auto'
                        }
                    </script>
                    <script src="https://cdn.jsdelivr.net/npm/docsify@4"></script>
                    <script src="https://cdn.jsdelivr.net/npm/docsify@4/lib/plugins/search.min.js"></script>
                    <script>
                        const content = `# ğŸ“Š Swift CSV

Lightweight and simple CSV import/export plugin for WordPress.

<span class="badge">v0.9.5</span>

## ğŸš€ Download

[Download Latest Release](https://github.com/firstelementjp/swift-csv/releases/latest){: .download-btn }

## âœ¨ Features

- ğŸŒ **Complete Internationalization** - Full Japanese translation support
- ğŸ“Š **Dynamic Progress Tracking** - Real-time progress with time estimation
- ğŸ¨ **Modern User Interface** - Professional admin interface
- ğŸ“ **Batch Processing** - Handle large CSV files without timeouts
- ğŸ¯ **Block Editor Compatible** - Preserves Gutenberg structure
- ğŸ›‘ **Cancel Operations** - Safe operation interruption

## ğŸš€ Installation

### Method 1: WordPress Admin

1. Go to **Admin Dashboard â†’ Plugins â†’ Add New**
2. Search for "Swift CSV"
3. Click **Install Now** â†’ **Activate**

### Method 2: Manual Installation

1. [Download swift-csv-0.9.5.zip](https://github.com/firstelementjp/swift-csv/releases/download/v0.9.5/swift-csv-0.9.5.zip)
2. Extract to get \`swift-csv/\` folder
3. Upload to \`/wp-content/plugins/\`
4. Activate from admin dashboard

## ğŸ“– Usage

### CSV Export

1. Navigate to **Swift CSV** in admin panel
2. Select **Export** tab
3. Choose post type and scope
4. Click **Export CSV**

### CSV Import

1. Navigate to **Swift CSV** â†’ **Import**
2. Select CSV file
3. Configure field mapping
4. Click **Import CSV**

## ğŸ”§ Requirements

- **WordPress**: 5.0+
- **PHP**: 7.4+
- **Memory**: 64MB+ recommended

## ğŸŒ Internationalization

- ğŸ‡ºğŸ‡¸ English (Default)
- ğŸ‡¯ğŸ‡µ Japanese (Complete)
- ğŸŒ Framework for additional languages

## ğŸ”— Links

- [GitHub Repository](https://github.com/firstelementjp/swift-csv)
- [Latest Release](https://github.com/firstelementjp/swift-csv/releases/latest)
- [Report Issues](https://github.com/firstelementjp/swift-csv/issues)

## ğŸ“„ License

Licensed under [GPLv2+](https://www.gnu.org/licenses/gpl-2.0.html).

---

**Made with â¤ï¸ by [FirstElement, Inc.](https://www.firstelement.co.jp/)**
                        `;
                        document.getElementById('app').innerHTML = content;
                    </script>
                </body>
                </html>
                HTML

            - name: Upload artifact
              uses: actions/upload-pages-artifact@v3
              with:
                path: ./docs

    deploy:
        environment:
            name: github-pages
            url: ${{ steps.deployment.outputs.page_url }}
        runs-on: ubuntu-latest
        needs: build
        if: github.ref == 'refs/heads/main' || github.event_name == 'release'

        steps:
            - name: Deploy to GitHub Pages
              id: deployment
              uses: actions/deploy-pages@v4
