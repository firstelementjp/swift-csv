function initLicense(){const n=document.getElementById("swift_csv_pro_license_key_input"),i=document.getElementById("swift_csv_pro_license_toggle_visibility");n&&i&&i.addEventListener("click",()=>{const s=n.type==="password";n.type=s?"text":"password",i.textContent=s?swiftCSV.messages.hide:swiftCSV.messages.show}),document.body.addEventListener("click",async s=>{const e=s.target.closest(".swift-csv-license-button");if(!e)return;const o=e.dataset.action;if(!o)return;const a=document.getElementById("swift_csv_pro_license_key_input"),l=a?a.value:"",t=e.closest("div")?e.closest("div").querySelector(".spinner"):null;if(!l&&o==="activate"){alert(SwiftCSVCore.__("Please enter a license key.","swift-csv-pro"));return}e.disabled=!0,t&&(t.style.display="inline-block");try{const r=await(await SwiftCSVCore.wpPost("swift_csv_pro_manage_license",{nonce:swiftCSV.nonce,license_key:l,license_action:o})).json();if(!r.success)throw new Error(r.data?.message||r.message||SwiftCSVCore.__("License operation failed.","swift-csv-pro"));location.reload()}catch(c){console.error("License error:",c),alert(c.message||SwiftCSVCore.__("An error occurred while processing your request. Please try again.","swift-csv-pro"))}finally{e.disabled=!1,t&&(t.style.display="none")}})}window.SwiftCSVLicense={initLicense};
