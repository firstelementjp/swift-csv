function initLicense(){const o=document.getElementById("swift_csv_pro_license_key_input"),c=document.getElementById("swift_csv_pro_license_toggle_visibility");o&&c&&c.addEventListener("click",()=>{const n=o.type==="password";o.type=n?"text":"password",c.textContent=n?swiftCSV.messages.hide:swiftCSV.messages.show}),document.body.addEventListener("click",async n=>{const e=n.target.closest(".swift-csv-license-button");if(!e)return;const t=e.dataset.action;if(!t){console.error("No action found on button:",e);return}console.log("License button clicked:",t);const l=document.getElementById("swift_csv_pro_license_key_input"),r=l?l.value:"",i=e.closest("div")?e.closest("div").querySelector(".spinner"):null;if(!r&&t==="activate"){alert(SwiftCSVCore.__("Please enter a license key.","swift-csv-pro"));return}console.log("Sending license request:",{action:t,licenseKey:r.substring(0,10)+"..."}),e.disabled=!0,i&&(i.style.display="inline-block");try{const s=await SwiftCSVCore.wpPost("swift_csv_pro_manage_license",{nonce:swiftCSV.nonce,license_key:r,license_action:t});if(console.log("License response:",s),!s.success)throw new Error(s.data?.message||SwiftCSVCore.__("License operation failed.","swift-csv-pro"));location.reload()}catch(s){console.error("License error:",s),alert(s.message||SwiftCSVCore.__("An error occurred while processing your request. Please try again.","swift-csv-pro"))}finally{e.disabled=!1,i&&(i.style.display="none")}})}window.SwiftCSVLicense={initLicense};
